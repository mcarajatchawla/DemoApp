library "SharedLib"
env.SONAR_HOST="http://localhost:9000/"
env.NEXUS_REPO="my-app-nexus-repo"
env.APP_GIT_URL="https://github.com/mcarajatchawla/DemoApp.git"
env.APP_BRANCH="master"
node {
    stage("Startup"){
        repoClone(env.APP_GIT_URL, env.APP_BRANCH)
    }
    stage("Maven Build"){
        mavenBuild()
    }

    stage("Code Analysis"){
        //sonarScan()
    }

    stage("Security Analysis"){
        parallel(
            checkmarx: {
                checkmarxScan()
            },
            nexusIQ: {
                nexusIQScan()
            }
        )
    }

    stage("Pubish to Nexus"){
        nexusUpload(env.NEXUS_REPO)
    }
}